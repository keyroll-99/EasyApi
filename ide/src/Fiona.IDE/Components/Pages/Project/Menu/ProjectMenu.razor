@using Fiona.IDE.Components.Pages.Project.Models
<BarItem>
    <BarDropdown>
        <BarDropdownToggle>Files</BarDropdownToggle>
        <BarDropdownMenu>
            <BarDropdownItem Clicked="OpenCreateNewFileModal">Create file</BarDropdownItem>
            @foreach (ProjectFile projectFile in ProjectManager.GetFiles() ?? [])
            {
                <BarDropdownItem>@projectFile.Name</BarDropdownItem>
            }
        </BarDropdownMenu>
    </BarDropdown>
</BarItem>

<CascadingValue Value="this">
    <CreateFileModal/>
</CascadingValue>

@code
{
    [Inject]
    public IProjectManager ProjectManager { get; init; } = default!;

    public bool ShowCreateNewFileModal { get; set; }

    public void CloseCreateNewFileModal()
    {
        ShowCreateNewFileModal = false;
    }

    public void OpenCreateNewFileModal()
    {
        ShowCreateNewFileModal = true;
    }

    public void AfterCreateNewFile()
    {
        StateHasChanged();
        CloseCreateNewFileModal();
    }
}